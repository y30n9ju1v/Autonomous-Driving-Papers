## 12.1 문제 정의

인간은 시간에 따른 관찰을 통해 깊이와 움직임 단서를 손쉽게 통합합니다. 이러한 종류의 추론은 3D 세계에서 움직이는 물체를 분할하는 것과 같은 자율 주행의 여러 작업에 필수적입니다. 씬 플로우(Scene flow)는 옵티컬 플로우(optical flow)를 3D로 일반화하거나, 동일하게, 밀집 스테레오(dense stereo)를 동적 장면에 적용합니다. 스테레오 이미지 시퀀스가 주어졌을 때, 목표는 장면에 있는 모든 가시 표면의 모든 지점에 대한 3D 움직임 벡터인 3차원 움직임 필드를 추정하는 것입니다. 이미지 기반 씬 플로우 추정을 위한 최소 설정은 그림 12.1에 시각화된 두 개의 연속적인 스테레오 이미지 쌍으로 제공됩니다. 네 이미지 간의 대응 관계를 설정하면 두 프레임 모두에서 표면 지점의 3D 위치를 알 수 있으며, 따라서 해당 표면 지점의 3D 움직임을 완전히 설명합니다. 조밀한 출력이 선호되지만, 일부 초기 연구는 희소 대응 관계를 설정하는 데 중점을 두었습니다. 씬 플로우는 약하게 텍스처링된 영역에서의 매칭 모호성 및 조리개 문제와 같은 스테레오 및 옵티컬 플로우와 일부 문제를 공유하지만, 네 이미지의 관찰을 통합하고 두 작업을 동시에 해결하면 문제가 더 잘 제약됩니다.

## 12.2 방법

Vedula 등의 선구적인 작업에 이어, 이 문제는 전통적으로 변분 설정으로 공식화되며, 최적화는 거친-세밀 방식으로 진행되고, 깊이와 움직임의 공간적 부드러움을 장려하기 위해 지역 정규화기가 활용됩니다. Wedel 등은 스테레오 제약을 유지하면서 움직임 추정과 시차 추정을 분리하여 변분 프레임워크를 제안합니다. 각 시간 단계에서 미리 계산된 시차 맵에서 시작하여, 참조 프레임에 대한 옵티컬 플로우와 다른 뷰에 대한 시차가 추정됩니다. 이러한 분리의 동기는 주로 각 작업에 대한 최적의 기술을 선택함으로써 얻는 계산 효율성입니다. 또한, Wedel 등은 잔차 이미지를 기반으로 하는 다양한 조명 조건에 대한 해결책을 제안하고, 객체 분할에 유용하다는 것을 보여준 불확실성 측정값을 제공합니다. Rabe 등은 시간적 부드러움과 견고성을 위해 Kalman 필터를 분리 접근 방식에 통합합니다.

### 12.2.1 조각별 강성 (Piecewise Rigidity)

스테레오 및 옵티컬 플로우와 유사하게, 장면 플로우 문제의 과제를 더 잘 처리하기 위해 기하학 및 움직임에 대한 사전 가정을 활용할 수 있습니다. Vogel 등 및 Lv 등은 그림 12.2에 표시된 바와 같이 동적 장면을 강체로 움직이는 평면 영역들의 모음으로 나타냅니다. Vogel 등은 각 영역의 모양과 움직임 매개변수를 추론하는 동시에 이러한 분할을 공동으로 복구합니다. 그들은 이산 최적화 프레임워크를 사용하고, 기하학, 움직임 및 분할의 공간적 정규화 형태의 다른 장면 사전 지식과 함께 오클루전 추론을 통합합니다. 또한, 그들은 분할이 시간적 창에서 안정적으로 유지되도록 제약함으로써 여러 프레임에 걸쳐 추론합니다. 그들의 실험은 뷰-일관성 다중 프레임 접근 방식이 어려운 시나리오에서 정확도를 크게 향상시킨다는 것을 보여줍니다. 동일한 표현을 사용하여, Lv 등은 문제에 대한 효율적인 해결책에 중점을 둡니다. 그들은 고정된 슈퍼픽셀 분할을 가정하고 더 빠른 추론을 위해 연속 도메인에서 최적화를 수행합니다. Deep Matching을 기반으로 한 초기화에서 시작하여, 장면의 기하학 및 움직임을 독립적으로 정제하고, 마지막으로 Levenberg-Marquardt 알고리즘을 사용하여 전역 비선형 정제를 수행합니다.

**객체 수준에서의 조각별 강성:** Menze와 Geiger 및 Behl 등도 경사 평면 접근 방식을 따르지만, 이전 방법에 더하여, 그들은 장면을 소수의 독립적으로 움직이는 객체와 배경으로 분해하는 것을 모델링합니다. 슈퍼픽셀화에 의존함으로써, 그들은 이 분해뿐만 아니라 객체의 강체 움직임과 이산-연속 조건부 랜덤 필드(CRF)에서 각 슈퍼픽셀의 평면 매개변수를 공동으로 추정합니다.와 비교하여, 그들은 더 먼 거리에 걸쳐 암묵적으로 정규화함으로써 더 간결한 표현을 활용합니다. 그들은 또한 상세한 3D CAD 모델을 사용하여 KITTI 원시 데이터 수집에서 동적 장면을 주석 처리하여 새로운 씬 플로우 데이터셋을 제시합니다. Menze 등은 강체 움직임 및 분할 외에 객체의 포즈와 3D 형상이 추론되는 이 모델의 확장을 제안합니다. 특히, 그들은 차량의 변형 가능한 3D 액티브 모양 모델을 씬 플로우 접근 방식에 통합합니다.

### 12.2.2 의미론적 분할 (Semantic Segmentation)

의미론적 정보는 가능한 강체 움직임의 공간을 제한할 수 있습니다. 예를 들어, 자율 주행 시나리오에서 분할에서 함께 그룹화된 픽셀은 차량의 경우 단일 강체로 움직일 가능성이 높습니다. 또한, 한 프레임의 차량 인스턴스에 있는 픽셀은 다른 프레임의 차량 인스턴스에 매핑되어야 합니다. Behl 등은 바운딩 박스 감지, 인스턴스 분할 및 3D 객체 좌표가 씬 플로우 추정에 미치는 영향을 조사하고, 어떤 것이 씬 플로우에 가장 유익한지 보여줍니다. 그들은 8장에서 논의된 제안 기반 인스턴스 분할 방법 MNC에서 바운딩 박스와 인스턴스 분할을 얻습니다. 3D 객체 좌표는 그림 12.3에 그림 12.3에 설명된 바와 같이 2D 인스턴스 분할에서 훈련된 CNN으로 예측됩니다.를 기반으로 한 CRF를 사용하여, 그들은 의미론적 단서가 상당한 개선을 가져온다는 것을 보여줍니다. 그러나 인스턴스 분할에 비해 3D 객체 좌표의 이점은 미미합니다. 최근 Ma 등은 인스턴스 분할(Mask R-CNN), 옵티컬 플로우(PWC-Net) 및 스테레오(PSM-Net)를 위한 CNN으로 구성된 여러 단서를 활용하여 씬 플로우 문제를 해결합니다. 그들은 모든 단서와 측광 항을 결합한 에너지를 공식화합니다. 최적화를 순환 네트워크로 펼쳐서 전체 파이프라인을 엔드-투-엔드로 훈련할 수 있습니다.

### 12.2.3 3D 포인트 클라우드로부터의 씬 플로우

이전에 논의된 이미지 기반 방법은 보정된 스테레오 카메라 장비의 두 연속 이미지 쌍을 기반으로 씬 플로우를 추정합니다. 그러나 스테레오 기반 씬 플로우 방법은 "두 뷰 기하학의 저주"로 인해 관찰자까지의 거리에 따라 깊이 오류가 이차적으로 증가하는 문제점을 안고 있습니다. 또한, 대부분의 최신 자율 주행 자동차 플랫폼은 3D 기하학 인식을 위해 LiDAR 기술에 의존합니다. 카메라와 달리 레이저 스캐너는 스테레오 카메라의 이차 오류 동작으로 인해 발생하는 문제점이 없습니다. 또한, 레이저 스캐너는 하나의 센서만으로 360도 시야를 제공하며 일반적으로 조명 조건의 영향을 받지 않습니다. 따라서 최근에는 비정형 3D 포인트 클라우드 쌍으로부터 3D 씬 플로우를 추정하기 위한 여러 방법이 제안되었습니다. Dewan 등은 지역적 부드러움과 강성 가정을 통합하는 CRF를 통해 지역 SHOT 디스크립터가 연관되는 3D 씬 플로우 접근 방식을 제안합니다. 그러나 SHOT과 같은 지역적 형상 표현은 노이즈가 많거나 모호한 입력이 있을 때 종종 실패합니다. 대조적으로, Behl 등은 데이터로부터 지역적 및 전역적 통계 관계를 직접 학습할 수 있는 일반적인 엔드-투-엔드 훈련 가능한 모델을 사용하여 씬 플로우 문제를 해결합니다. 표준 3D 컨볼루션 연산을 적용하기 위해 포인트 클라우드를 복셀 그리드로 이산화합니다. 그러나 LiDAR 데이터의 희소한 특성 때문에 대부분의 공간이 비어 있어 이 접근 방식은 계산 및 메모리 효율성이 떨어집니다. 이 문제를 완화하기 위해 Wang 등은 비격자 구조 데이터에서 작동하는 새로운 연속 컨볼루션을 제안합니다.

## 12.3 데이터셋

씬 플로우에 대한 데이터셋은 몇 개 밖에 존재하지 않습니다. 플로우 및 스테레오와 유사하게, KITTI 씬 플로우 벤치마크는 온라인 평가 서버에서 방법들을 비교할 수 있게 하는 가장 인기 있는 데이터셋입니다. 딥 러닝의 경우, KITTI가 너무 작기 때문에 Flying Things 데이터셋이 종종 사전 훈련에 사용됩니다. 최근 MPI Sintel은 훈련 데이터셋을 위해 스테레오 시퀀스를 공개했으며, 그 이후 KITTI의 거리 장면 외의 다른 장면에 대한 씬 플로우 접근 방식의 일반화를 보여주는 데 사용됩니다.

## 12.4 측정 지표

씬 플로우 방법은 일반적으로 스테레오 (섹션 9.4) 및 옵티컬 플로우 추정치 (섹션 11.4)의 정확도를 공동으로 측정하여 평가됩니다. KITTI 벤치마크는 오류 픽셀의 비율을 고려합니다. 픽셀은 지상 진실과의 유클리드 거리가 3픽셀 또는 5% 임계값을 초과하는 경우 오류로 간주됩니다. 첫 번째 프레임의 스테레오 시차 이상치(D1), 두 번째 프레임의 스테레오 시차 이상치(D2), 옵티컬 플로우 이상치(Fl), 그리고 씬 플로우 이상치(SF), 즉 D0, D1 또는 Fl 중 하나에서 이상치의 비율이 보고됩니다. 전경/배경 영역에 대한 이상치 비율은 벤치마크 웹사이트에서 별도로 찾을 수 있지만, 여기서는 공간 제약으로 인해 생략됩니다.

## 12.5 KITTI의 최신 기술

표 12.1은 KITTI 씬 플로우 2015 벤치마크에서 방법들의 순위를 보여줍니다.

모든 최고 성능 방법은 의미론적 단서 또는 강체로 움직이는 세그먼트 가정을 사용합니다. 강체 변환을 사용하여 객체의 움직임을 모델링하는 것은 KITTI 데이터셋에서 인상적인 결과를 달성합니다. 그러나 이것은 보행자의 비강체성을 처리할 수 없으므로 거리 장면에서도 매우 강력한 가정입니다. 대조적으로, 장면을 슈퍼픽셀로 분할하는 것은 이 문제를 완화하고 비강체 객체가 여러 슈퍼픽셀로 모델링될 수 있으므로 더 나은 성능을 허용합니다. 그러나 가장 좋은 성능은 의미론적 정보를 통합함으로써 달성됩니다. 대부분의 씬 플로우 접근 방식은 매우 비효율적이지만, Ma 등의 방법은 주목할 만한 예외이며, 단 0.75초만 필요합니다. 그들은 인스턴스 분할(Mask R-CNN), 옵티컬 플로우(PWC-Net) 및 스테레오(PSM-Net)를 위한 CNN을 결합하여 씬 플로우 문제를 해결하고 추론을 위해 GPU를 활용함으로써 이러한 효율성을 달성합니다 (CPU에서 실행되는 기존 씬 플로우 접근 방식과 대조적으로).

## 12.6 논의

씬 플로우 문제는 스테레오 및 옵티컬 플로우와 많은 과제를 공유하면서도 각 작업 단독보다 더 많은 정보를 통합하여 결과적으로 더 나은 결과를 가져옵니다. 이상적으로는, 방법들이 깊이와 움직임 단서를 함께 활용하여 동적 3D 장면에 대해 추론해야 합니다. 그러나 옵티컬 플로우(표 11.1) 및 스테레오 매칭 리더보드(표 9.1)를 고려할 때, 공동 공식화는 옵티컬 플로우 문제에 더 유리하여 UberATG-DRISF가 4.73%의 이상치 비율에 도달하는 반면 PWC-Net+는 7.72%에 도달하는 것과 같이 상당한 개선을 가져옵니다. 대조적으로, 스테레오 매칭 성능은 2.55%(UberATG-DRISF)의 이상치 비율과 2.08%(EdgeStereo-V2)를 비교할 때 유사합니다.

그림 12.4에서는 KITTI 씬 플로우 벤치마크에서 상위 5개 방법의 누적 오류를 보여줍니다. 자동차 표면은 매칭 문제와 자동차의 독립적인 움직임으로 인해 가장 문제가 되는 영역입니다. 이미지 경계에 가까운 픽셀은 특히 자동차 앞 도로 표면에서 큰 규모 변화가 발생하는 경우 또 다른 일반적인 오류 원인입니다. 지역적 평면성 및 강성 가정이 문제를 완화하지만, 식생, 보행자 또는 자전거와 같은 복잡한 기하학적 객체로 인해 종종 위반됩니다. 잘못된 평면 추정으로 인해 다른 표면을 그룹화하는 슈퍼픽셀은 특히 객체 경계에서 추가적인 문제를 유발합니다. 의미론적 이미지 이해는 특히 객체 수준에서 자동차 인스턴스를 분할함으로써 유망한 방향으로 보입니다. 그러나 이 정보를 얻기 위해 추가 네트워크를 훈련해야 하며, 예측 오류는 최종 씬 플로우 추정에서 되돌릴 수 없는 오류를 초래할 수 있습니다. 시간적 정보를 활용하는 것도 개선으로 이어지며 가능할 때마다 활용해야 합니다. 특히, 장기 시간적 상호 작용은 모호성을 완화하고 개선하는 데 도움이 될 수 있습니다. 그러나 견고하고 정확하며 실시간 다중 프레임 씬 플로우 추정치를 얻는 것은 추가 작업이 필요한 미해결 문제로 남아 있습니다.